# AlexandercheOTUS_infra
AlexandercheOTUS Infra repository
-----------------------------------------------------------------------------------------------------------------------------------------------------------
cloud_bastion
Домашнее задание №3 "Знакомство с облачной инфраструктурой и облачными сервисами" от 15 июня, вторник в 20:00
Дополнительное задание: подключиться к виртуалке someinternalhost через виртуалку bastion с локальной тачки:
avc@ARM01-R90XLA6N:~/_github/AlexandercheOTUS_infra$ echo "alias someinternalhost='ssh -i /home/avc/_github/ssh_key/yandex_cloud/appuser -A appuser@178.154.203.95 -t "ssh 10.128.0.3"'" >> ~/.bashrc && source ~/.bashrc
avc@ARM01-R90XLA6N:~/_github/AlexandercheOTUS_infra$ someinternalhost
Welcome to Ubuntu 16.04.7 LTS (GNU/Linux 4.4.0-142-generic x86_64)
 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage
appuser@someinternalhost:~$ logout
Connection to 10.128.0.3 closed.
Connection to 178.154.228.89 closed.
-----------------------------------------------------------------------------------------------------------------------------------------------------------
bastion_IP = 178.154.228.89 
someinternalhost_IP = 10.128.0.3
-----------------------------------------------------------------------------------------------------------------------------------------------------------
cloud-testapp
Домашнее задание №4 "Основные сервисы Yandex Cloud" от 17 июня, четверг 20:00
testapp_IP = 178.154.206.60
testapp_port = 9292
Скрипт (bash) для автосоздания инстанса (reddit-app-2) с приложением reddit (puma) внутри запускается из корня репозитория:
$ ./yc_create_redditapp.sh  
-----------------------------------------------------------------------------------------------------------------------------------------------------------
terraform-1
Домашнее задание №6 "Декларативное описание в виде кода инфраструктуры YC, требуемой для запуска тестового приложения, при помощи Terraform."
Деплоили терраформом всячески. Сейчас мой Monolit на http://84.201.173.189:9292/
-----------------------------------------------------------------------------------------------------------------------------------------------------------
terraform-2
Домашнее задание №7 "Создание Terraform модулей для управления компонентами инфраструктуры."
packer-ом созданы 2 новых образа для приложения и его базы данных. Конфиг terraform разобран на модули. Конфиг terraform для stage и prod сред. 
-----------------------------------------------------------------------------------------------------------------------------------------------------------
ansible-1
Домашнее задание №8 "Написание Ansible плейбуков на основе имеющихся bash скриптов."
После
$ ansible app -m command -a 'rm -rf ~/reddit'
запуск
$ ansible-playbook clone.yml
внес изменения:
changed=1
-----------------------------------------------------------------------------------------------------------------------------------------------------------
ansible-2
Домашнее задание №9 "Управление настройками хостов и деплой приложения при помощи Ansible."
Сбился со счета сколько раз пересоздавал terraform-ом инфраструктуру и редеплоил приложение ansible-ом...
-----------------------------------------------------------------------------------------------------------------------------------------------------------
ansible-3
Домашнее задание №10 "Написание Ansible ролей для управления конфигурацией сервисов и настройками хостов"
Добавлено: роли app и db, окружение stage и prod c переменными и инвентори, роль для nginx-proxy из ansible-galaxy, создание пользователей из зашифрованных ansible-vault кредов. Настроил себе на машине bash-completion для ансибла. Множественные редеплои инфраструктуры с раскаткой ансиблом - всё работает.  
-----------------------------------------------------------------------------------------------------------------------------------------------------------
